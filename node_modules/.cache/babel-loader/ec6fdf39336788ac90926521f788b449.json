{"ast":null,"code":"import { useCallback } from 'react';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport useAuthProvider, { defaultAuthParams } from './useAuthProvider';\nimport { resetNotification } from '../actions/notificationActions';\n/**\n * Get a callback for calling the authProvider.login() method\n * and redirect to the previous authenticated page (or the home page) on success.\n *\n * @see useAuthProvider\n *\n * @returns {Function} login callback\n *\n * @example\n *\n * import { useLogin } from 'react-admin';\n *\n * const LoginButton = () => {\n *     const [loading, setLoading] = useState(false);\n *     const login = useLogin();\n *     const handleClick = {\n *         setLoading(true);\n *         login({ username: 'john', password: 'p@ssw0rd' }, '/posts')\n *             .then(() => setLoading(false));\n *     }\n *     return <button onClick={handleClick}>Login</button>;\n * }\n */\n\nvar useLogin = function useLogin() {\n  var authProvider = useAuthProvider();\n  var location = useLocation();\n  var locationState = location.state;\n  var history = useHistory();\n  var dispatch = useDispatch();\n  var nextPathName = locationState && locationState.nextPathname;\n  var nextSearch = locationState && locationState.nextSearch;\n  var login = useCallback(function (params, pathName) {\n    if (params === void 0) {\n      params = {};\n    }\n\n    return authProvider.login(params).then(function (ret) {\n      dispatch(resetNotification());\n      var redirectUrl = pathName ? pathName : nextPathName + nextSearch || defaultAuthParams.afterLoginUrl;\n      history.push(redirectUrl);\n      return ret;\n    });\n  }, [authProvider, history, nextPathName, nextSearch, dispatch]);\n  var loginWithoutProvider = useCallback(function (_, __) {\n    dispatch(resetNotification());\n    history.push(defaultAuthParams.afterLoginUrl);\n    return Promise.resolve();\n  }, [history, dispatch]);\n  return authProvider ? login : loginWithoutProvider;\n};\n\nexport default useLogin;","map":null,"metadata":{},"sourceType":"module"}