{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React, { Component, createElement, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport classnames from 'classnames';\nimport { withRouter } from 'react-router-dom';\nimport { withStyles, createStyles } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { ComponentPropType } from 'ra-core';\nimport compose from 'lodash/flowRight';\nimport DefaultAppBar from './AppBar';\nimport DefaultSidebar from './Sidebar';\nimport DefaultMenu from './Menu';\nimport DefaultNotification from './Notification';\nimport DefaultError from './Error';\nimport defaultTheme from '../defaultTheme';\nimport SkipNavigationButton from '../button/SkipNavigationButton';\nimport { createMuiTheme } from './createMuiTheme';\n\nvar styles = function styles(theme) {\n  var _a, _b;\n\n  return createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'column',\n      zIndex: 1,\n      minHeight: '100vh',\n      backgroundColor: theme.palette.background.default,\n      position: 'relative',\n      minWidth: 'fit-content',\n      width: '100%',\n      color: theme.palette.getContrastText(theme.palette.background.default)\n    },\n    appFrame: (_a = {\n      display: 'flex',\n      flexDirection: 'column',\n      flexGrow: 1\n    }, _a[theme.breakpoints.up('xs')] = {\n      marginTop: theme.spacing(6)\n    }, _a[theme.breakpoints.down('xs')] = {\n      marginTop: theme.spacing(7)\n    }, _a),\n    contentWithSidebar: {\n      display: 'flex',\n      flexGrow: 1\n    },\n    content: (_b = {\n      display: 'flex',\n      flexDirection: 'column',\n      flexGrow: 1,\n      flexBasis: 0,\n      padding: theme.spacing(3),\n      paddingTop: theme.spacing(1),\n      paddingLeft: 0\n    }, _b[theme.breakpoints.up('xs')] = {\n      paddingLeft: 5\n    }, _b[theme.breakpoints.down('sm')] = {\n      padding: 0\n    }, _b)\n  });\n};\n\nvar LayoutWithoutTheme = function (_super) {\n  __extends(LayoutWithoutTheme, _super);\n\n  function LayoutWithoutTheme(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      hasError: false,\n      errorMessage: null,\n      errorInfo: null\n    };\n    /**\n     * Reset the error state upon navigation\n     *\n     * @see https://stackoverflow.com/questions/48121750/browser-navigation-broken-by-use-of-react-error-boundaries\n     */\n\n    props.history.listen(function () {\n      if (_this.state.hasError) {\n        _this.setState({\n          hasError: false\n        });\n      }\n    });\n    return _this;\n  }\n\n  LayoutWithoutTheme.prototype.componentDidCatch = function (errorMessage, errorInfo) {\n    this.setState({\n      hasError: true,\n      errorMessage: errorMessage,\n      errorInfo: errorInfo\n    });\n  };\n\n  LayoutWithoutTheme.prototype.render = function () {\n    var _a = this.props,\n        appBar = _a.appBar,\n        children = _a.children,\n        classes = _a.classes,\n        className = _a.className,\n        error = _a.error,\n        dashboard = _a.dashboard,\n        logout = _a.logout,\n        menu = _a.menu,\n        notification = _a.notification,\n        open = _a.open,\n        sidebar = _a.sidebar,\n        title = _a.title,\n        // sanitize react-router props\n    match = _a.match,\n        location = _a.location,\n        history = _a.history,\n        staticContext = _a.staticContext,\n        props = __rest(_a, [\"appBar\", \"children\", \"classes\", \"className\", \"error\", \"dashboard\", \"logout\", \"menu\", \"notification\", \"open\", \"sidebar\", \"title\", \"match\", \"location\", \"history\", \"staticContext\"]);\n\n    var _b = this.state,\n        hasError = _b.hasError,\n        errorMessage = _b.errorMessage,\n        errorInfo = _b.errorInfo;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", __assign({\n      className: classnames('layout', classes.root, className)\n    }, props), React.createElement(SkipNavigationButton, null), React.createElement(\"div\", {\n      className: classes.appFrame\n    }, createElement(appBar, {\n      title: title,\n      open: open,\n      logout: logout\n    }), React.createElement(\"main\", {\n      className: classes.contentWithSidebar\n    }, createElement(sidebar, {\n      children: createElement(menu, {\n        logout: logout,\n        hasDashboard: !!dashboard\n      })\n    }), React.createElement(\"div\", {\n      id: \"main-content\",\n      className: classes.content\n    }, hasError ? createElement(error, {\n      error: errorMessage,\n      errorInfo: errorInfo,\n      title: title\n    }) : children)))), createElement(notification));\n  };\n\n  LayoutWithoutTheme.propTypes = {\n    appBar: ComponentPropType,\n    children: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n    classes: PropTypes.object,\n    className: PropTypes.string,\n    dashboard: ComponentPropType,\n    error: ComponentPropType,\n    history: PropTypes.object.isRequired,\n    logout: PropTypes.element,\n    menu: ComponentPropType,\n    notification: ComponentPropType,\n    open: PropTypes.bool,\n    sidebar: ComponentPropType,\n    title: PropTypes.node.isRequired\n  };\n  LayoutWithoutTheme.defaultProps = {\n    appBar: DefaultAppBar,\n    error: DefaultError,\n    menu: DefaultMenu,\n    notification: DefaultNotification,\n    sidebar: DefaultSidebar\n  };\n  return LayoutWithoutTheme;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    open: state.admin.ui.sidebarOpen\n  };\n};\n\nvar EnhancedLayout = compose(connect(mapStateToProps, {} // Avoid connect passing dispatch in props\n), withRouter, withStyles(styles, {\n  name: 'RaLayout'\n}))(LayoutWithoutTheme);\n\nvar Layout = function Layout(_a) {\n  var themeOverride = _a.theme,\n      props = __rest(_a, [\"theme\"]);\n\n  var themeProp = useRef(themeOverride);\n\n  var _b = useState(function () {\n    return createMuiTheme(themeOverride);\n  }),\n      theme = _b[0],\n      setTheme = _b[1];\n\n  useEffect(function () {\n    if (themeProp.current !== themeOverride) {\n      themeProp.current = themeOverride;\n      setTheme(createMuiTheme(themeOverride));\n    }\n  }, [themeOverride, themeProp, theme, setTheme]);\n  return React.createElement(ThemeProvider, {\n    theme: theme\n  }, React.createElement(EnhancedLayout, __assign({}, props)));\n};\n\nLayout.propTypes = {\n  theme: PropTypes.object\n};\nLayout.defaultProps = {\n  theme: defaultTheme\n};\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}