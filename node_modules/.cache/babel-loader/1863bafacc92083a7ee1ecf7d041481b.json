{"ast":null,"code":"import { useState, useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare a set of callbacks for a delete button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         loading,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         basePath,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={loading}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\n\nvar useDeleteWithConfirmController = function useDeleteWithConfirmController(props) {\n  var record = props.record,\n      redirectTo = props.redirect,\n      basePath = props.basePath,\n      mutationMode = props.mutationMode,\n      onClick = props.onClick,\n      _onSuccess = props.onSuccess,\n      _onFailure = props.onFailure;\n  var resource = useResourceContext(props);\n\n  var _a = useState(false),\n      open = _a[0],\n      setOpen = _a[1];\n\n  var notify = useNotify();\n  var redirect = useRedirect();\n  var refresh = useRefresh();\n\n  var _b = useDelete(resource, null, null, {\n    action: CRUD_DELETE,\n    onSuccess: function onSuccess(response) {\n      setOpen(false);\n\n      if (_onSuccess === undefined) {\n        notify('ra.notification.deleted', 'info', {\n          smart_count: 1\n        });\n        redirect(redirectTo, basePath || \"/\" + resource);\n        refresh();\n      } else {\n        _onSuccess(response);\n      }\n    },\n    onFailure: function onFailure(error) {\n      setOpen(false);\n\n      if (_onFailure === undefined) {\n        notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', 'warning', {\n          _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n        });\n        refresh();\n      } else {\n        _onFailure(error);\n      }\n    },\n    mutationMode: mutationMode\n  }),\n      deleteOne = _b[0],\n      loading = _b[1].loading;\n\n  var handleDialogOpen = function handleDialogOpen(e) {\n    setOpen(true);\n    e.stopPropagation();\n  };\n\n  var handleDialogClose = function handleDialogClose(e) {\n    setOpen(false);\n    e.stopPropagation();\n  };\n\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    deleteOne({\n      payload: {\n        id: record.id,\n        previousData: record\n      }\n    });\n\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, onClick, record]);\n  return {\n    open: open,\n    loading: loading,\n    handleDialogOpen: handleDialogOpen,\n    handleDialogClose: handleDialogClose,\n    handleDelete: handleDelete\n  };\n};\n\nexport default useDeleteWithConfirmController;","map":null,"metadata":{},"sourceType":"module"}